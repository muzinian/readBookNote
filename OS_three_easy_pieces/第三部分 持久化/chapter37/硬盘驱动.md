## 硬盘驱动
上一章介绍了I/O设备通用概念，同时向你展示OS是如何和这样一个怪兽交互的。在本章，我们将深入到一个特定设备具体细节：__硬盘驱动__。在过去十几年这些驱动已经成为了计算机系统主要的持久化数据存储形式，大多数文件系统技术(即将介绍)的开发是基于这些设备的行为的。因此，在构建文件系统软件管理这些设备前了解这些硬盘的操作细节是很值得的。这些细节很多都存在于Ruemmler和Wilkes，Anderson，Dykes和Riedel的论文中。
>####症结：如何读写硬盘上的数据
>现代硬盘驱动是如何存储数据的？接口是什么？数据实际布局和访问是什么样的？硬盘调度是怎么提升性能的？
###37.1 接口
让我们以通过先理解现代硬盘驱动的接口作为开始。对于所有现代驱动基本结构很直接。驱动是由大量的扇区(512字节块)组成的，每个扇区都可以读写。一个有这个$n$个扇区的硬盘扇区号是从$0$到$n-1$。因此，我们可以把硬盘看作扇区的数组；$0$到$n-1$就是这个驱动的 __地址空间__。

多扇区操作是可能的；事实上，很多文件系统会一次读写4KB(或者更多)。然而，当更新硬盘，驱动制造商唯一的保证就是单个512字节的写入是 __原子__ 的(例如，它要么全部完成要么全部失败)；因此，如果发生了不适宜的断电，一个比较大的写入操作可能只有一部分是完成的(有时候称作 __撕裂写(torn write)__)。

有一些假设是大部分硬盘驱动客户端会做的，但是在接口里面没有直接规定；Schlosser和Ganger称这个是硬盘驱动的"为编写协议"。具体来说，我们通常可以假设访问两个在驱动地址空间临近的块会比访问距离比较远的块要快。我们还可以假设访问在一个连续大块中的小块(例如，顺序读或者顺序写)是最快的访问模式，通常比任何随机访问模式都要快。

###37.2 基本几何结构
